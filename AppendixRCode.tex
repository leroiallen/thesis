\documentclass[12pt,a4paper,oneside]{report}
\usepackage{fancyhdr}	
%\usepackage{fancyheadings}	
\usepackage{geometry}%[margin=2.5cm, a4paper][top=15mm, bottom=15mm, left=35mm, right=15mm]
\usepackage{amsmath}			% packages to give lots of maths stuff
\usepackage{amssymb}
\usepackage{color}
\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an inden
\usepackage{graphicx}	
\usepackage{fancyvrb}
\usepackage{array}
\usepackage{listings}
\usepackage{amsthm}
\usepackage{dsfont}

%\usepackage[latin1]{inputenc}
%%% make dejvu monospace default tt font
\usepackage[scaled=.8]{beramono}
\usepackage[T1]{fontenc}

\setlength{\textwidth}{150.0mm}
\setlength{\textheight}{220.0mm}


% Set up the naming conventions for equations etc
\renewcommand{\theequation}{\arabic{chapter}.\arabic{equation}}%.\arabic{section}
\renewcommand{\thefigure}{\arabic{chapter}.\arabic{figure}}%.\arabic{section}
\renewcommand{\thetable}{\arabic{chapter}.\arabic{table}}%.\arabic{section}


%% This is for the Verbatim environments using pygments
%% shortlist: paraiso-light, manni, autumn, xcode, default, trac, native, friendly
\input{tex/99_manniedited}



\lhead[\fancyplain{}{\thepage}]{\fancyplain{}{\nouppercase\rightmark}}
\rhead[\fancyplain{}{\nouppercase\leftmark}]{\fancyplain{}{\thepage}}
\cfoot{}


%\pagestyle{empty}
 
 
\begin{document}

\pagenumbering{roman}

\tableofcontents

\clearpage


\pagenumbering{arabic}
\pagestyle{fancy}
% What do you want at the top and bottom of a page (see fancyheadings.sty)
%\rhead{\thepage}
%\rhead{\thepage}






\definecolor{linkblue}{rgb}{0.192,0.494,0.675}
\definecolor{fngrey}{rgb}{0.220,0.220,0.251}	

\newcommand{\codetab}[1]{%
\begin{center}
\begin{tabular}{m{4.5cm}m{5cm}r}
\hline
\textsf{Description} & \textsf{File} & \textsf{Functions} \\
  \hline
#1
   \hline
\end{tabular}
\end{center}
}
\newcommand{\codeentry}[3]{%
\multicolumn{3}{l}{\textsf{#1:}} \\
 &  \texttt{\textcolor{linkblue}{/#2}}  & \textcolor{fngrey}{\texttt{#3}} \\ %
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%      Appendices        %%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




% Set up the naming conventions for equations in the appendices
\renewcommand{\theequation}{\Alph{chapter}.\arabic{equation}} %\arabic{section}.
 

%\renewcommand{\theequation}{\arabic{chapter}.\arabic{equation}}%.\arabic{section}
%\renewcommand{\thefigure}{\arabic{chapter}.\arabic{figure}}%.\arabic{section}
%\renewcommand{\thetable}{\arabic{chapter}.\arabic{table}}%.\arabic{section}

\begin{appendix}

\addtocontents{toc}{\setcounter{tocdepth}{3}}



\chapter{\texttt{R} code} \label{app:R}


All files referenced in the current appendix are available under the directory at:
\begin{center}
\texttt{\textcolor{linkblue}{https://github.com/tystan/thesis/tree/master/R}}.
\end{center}



\clearpage


\section{Morphological operators}



\begin{center}
\begin{tabular}{m{3cm}m{5cm}r}
\hline
\textsf{Description} & \textsf{File} & \textsf{Functions} \\
  \hline
\codeentry{Naive erosion and top-hat}{00\_erosion\_slow.R}{erode(), dilate(), tophat()}
\codeentry{Line segment erosion}{01\_erosion\_quick.R}{erode\_quick()}
\codeentry{Naive erosion for unequally spaced values}{02\_cts\_erosion\_slow.R}{erode\_cts\_slow()}
\codeentry{Continuous line segment erosion}{03\_cts\_erosion\_quick.R}{erode\_cts\_quick()}
   \hline
\end{tabular}
\end{center}

\clearpage

\subsection{Naive erosion and top-hat} 

Consider $x \in \left\{ 1,2,\ldots,n \right\} = X$ and $ f \left( x \right) \in \mathds{R} \; \; \forall x \in X$. Because of the assumed even spacing of the elements of $X$, the {\tt R}-function below simply requires the vector of intensities, $f$, and the size of the SE. \\


	\input{tex/00_erosion_slow}

\vskip12pt


Note, the code checks the SE provided is an odd integer as a centred, symmetric SE is required. The maximum and minimum statements on line 6 of the code segment above, namely {\tt max(1,i-halfse)} and {\tt min(nx,i+halfse)}, check for when the SE sits over the `edge' on the left or right of the series, respectively. This ensures only defined $f$ values will be used. 
	
\clearpage	
	
\subsection{Line segment erosion} 


	\input{tex/01_erosion_quick}

\clearpage
		
\subsection{Naive erosion for unequally spaced values}


A vector of all the lower bounds (LB) $x_l$ in Algorithm \ref{alg1} for each corresponding $x_i$ can be created using a $O (n)$ algorithm using two pointers along the input vector $X$. One pointer is the current position, the other is a lagging pointer that moves along the vector when required. A simple algorithm to do this is described in Algorithm \ref{alg2}. To find the upper bound the same algorithm would be employed, but the pointers will start from the right and move down the vector with the second point lagging to the right.\\[15pt]


	\input{tex/02_cts_erosion_slow}


	\clearpage



\subsection{Continuous line segment erosion} 


	\input{tex/03_cts_erosion_quick}






\clearpage


\section{Spectra normalisation}

\codetab{
\codeentry{Empirical quantile normalisation}{04\_quant\_norm.R}{msEQN()}
\codeentry{Pairwise spectra MA normalisation}{05\_ma\_adj.R}{intensAdj()}
}

\clearpage

\subsection{Empirical quantile normalisation} 

	\input{tex/04_quant_norm}
	
\clearpage

\subsection{Pairwise spectra MA normalisation} 

	\input{tex/05_ma_adj}
	
\clearpage




\section{Peak alignment} \label{pacodes}


\codetab{
\codeentry{Calculate $W$ matrix for an $N$- and $M$-alignment}{06\_create\_w.R}{Wmatrix()}
\codeentry{Dendrogram peak alignment}{07\_dendro\_peak\_align.R}{dendro\_peak\_align()}
}
\clearpage

\subsection{Calculate $W$ matrix for an $N$- and $M$-alignment} 

	\input{tex/06_create_w}

\clearpage

\subsection{Dendrogram peak alignment} 


	\input{tex/07_dendro_peak_align}






	
	
\clearpage

\section{Surrogate variable analysis} \label{sva}


\codetab{
\codeentry{Get SVA adjusted expression matrix}{08\_do\_sva.R}{doSVA()}
}

\clearpage

\subsection{Get SVA adjusted expression matrix}

Please note the function \texttt{getH()} (line 47 below) is the code available in the \texttt{DanteR} package to determine the number of significant surrogate variables. The function \texttt{mulReg(Y,X)} performs sequential linear regressions on the columns of the input \texttt{Y} using a fixed effects design matrix \texttt{X}. \texttt{mulReg()} returns a list containing the following vectors and matrices: \texttt{RES}$_{n \times P}$, residual matrix after \texttt{Y} has been regressed; \texttt{BETA}$_{d \times P}$, matrix of the regression coefficients, $P$ columns for each regression; \texttt{TVALS}$_{d \times P}$, the corresponding $t$-statistics; \texttt{PVALS}$_{d \times P}$ the corresponding $p$-values of \texttt{TVALS}; \texttt{FPVALS}$_{P\times 1}$, $p$-value for each linear regression corresponding to the null model $F$-statistic.

	\input{tex/08_do_sva}
	
	
	
	
	
\clearpage



\section{Pairwise fusion linear discriminant analysis} 

\codetab{
\codeentry{Create a PFDA object}{09\_create\_pfda\_obj.R}{create\_pfda\_obj()}
\codeentry{Predict class for new data and a PFDA object}{10\_pfda\_predict.R}{pfda\_predict()}
}


\clearpage

\subsection{Create a PFDA object}

	\input{tex/09_create_pfda_obj}

\clearpage

\subsection{Predict class for new data and a PFDA object}

	\input{tex/10_pfda_predict}

\clearpage



\section{Pareto Fronts for variable ranking} 


\codetab{
\codeentry{Calculate dominating features}{11\_dom\_feat.c}{domfeat()}
\codeentry{Pareto Front wrapper functions}{12\_pareto\_fronts.R}{paretoRanking()}
}

\clearpage

\subsection{Calculate dominating features} 

Below is the core of the Pareto Front code, finding features that are the dominated as per the definition. Written in {\tt C} to be compiled to a {\tt .so} file (or \texttt{.dll} on Windows operating systems) that in turn can be loaded into {\tt R}.

	\input{tex/11_dom_feat}

\clearpage

\subsection{Pareto Front wrapper functions} 

	\input{tex/12_pareto_fronts}


\end{appendix}








\end{document}  


